{% extends "base.html" %}
{% block content %}
<div class="container">
  <a href="{% url 'restaurant_detail' restaurant.id %}"><button class="secondary-btn">Back to Restaurant</button></a>
  <h2>Add Menu for {{ restaurant.name }}</h2>
  
  <form method="post" id="menu-form">
    {% csrf_token %}
    
    <h3>Menu Items</h3>
    <div id="menu-items">
      <div class="menu-item">
        <label>Item Name:</label>
        <input type="text" name="item_name_0">
        <label>Description (optional):</label>
        <textarea name="item_description_0"></textarea>
        <label>Price:</label>
        <input type="number" step="0.01" name="item_price_0">
      </div>
    </div>
    <button type="button" onclick="addMenuItem()">+ Add Menu Item</button>
    
    <hr style="margin: 30px 0;">
    
    <h3>Happy Hour</h3>
    <div id="happy-hour-container">
      <!-- Happy hour entries will be added here -->
    </div>
    <input type="hidden" id="happy-hour-count" name="happy_hour_count" value="0">
    <button type="button" onclick="addHappyHour()">+ Add Happy Hour</button>
    
    <hr style="margin: 30px 0;">
    
    <button type="submit">Save Menu</button>
  </form>

  <script>
    let itemCount = 1;
    let happyHourCount = 0;
    
    function addMenuItem() {
      const container = document.getElementById('menu-items');
      const div = document.createElement('div');
      div.className = 'menu-item';
      div.innerHTML = `
        <label>Item Name:</label>
        <input type="text" name="item_name_${itemCount}">
        <label>Description (optional):</label>
        <textarea name="item_description_${itemCount}"></textarea>
        <label>Price:</label>
        <input type="number" step="0.01" name="item_price_${itemCount}">
      `;
      container.appendChild(div);
      itemCount++;
    }
    
    function addHappyHour() {
      const container = document.getElementById('happy-hour-container');
      const div = document.createElement('div');
      div.className = 'happy-hour-entry';
      div.style.border = '1px solid #ddd';
      div.style.padding = '15px';
      div.style.marginBottom = '15px';
      div.style.borderRadius = '5px';
      div.innerHTML = `
        <h4>Happy Hour Time Slot</h4>
        
        <label>Days (select all that apply):</label>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 15px;">
          <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" name="hh_days_${happyHourCount}" value="monday" style="margin: 0; width: 18px; height: 18px; cursor: pointer;">
            <span style="margin: 0;">Monday</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" name="hh_days_${happyHourCount}" value="tuesday" style="margin: 0; width: 18px; height: 18px; cursor: pointer;">
            <span style="margin: 0;">Tuesday</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" name="hh_days_${happyHourCount}" value="wednesday" style="margin: 0; width: 18px; height: 18px; cursor: pointer;">
            <span style="margin: 0;">Wednesday</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" name="hh_days_${happyHourCount}" value="thursday" style="margin: 0; width: 18px; height: 18px; cursor: pointer;">
            <span style="margin: 0;">Thursday</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" name="hh_days_${happyHourCount}" value="friday" style="margin: 0; width: 18px; height: 18px; cursor: pointer;">
            <span style="margin: 0;">Friday</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" name="hh_days_${happyHourCount}" value="saturday" style="margin: 0; width: 18px; height: 18px; cursor: pointer;">
            <span style="margin: 0;">Saturday</span>
          </label>
          <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" name="hh_days_${happyHourCount}" value="sunday" style="margin: 0; width: 18px; height: 18px; cursor: pointer;">
            <span style="margin: 0;">Sunday</span>
          </label>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
          <div>
            <label>Start Time:</label>
            <input type="time" name="hh_start_time_${happyHourCount}" required>
          </div>
          <div>
            <label>End Time:</label>
            <input type="time" name="hh_end_time_${happyHourCount}" required>
          </div>
        </div>
        
        <label>Specials:</label>
        <textarea name="hh_specials_${happyHourCount}" placeholder="e.g., $5 appetizers, $6 cocktails, Half off wine" style="width: 100%; min-height: 60px;"></textarea>
        
        <button type="button" onclick="this.parentElement.remove(); updateHappyHourCount();" style="background: #dc3545; color: white; padding: 5px 10px; margin-top: 10px;">Remove</button>
      `;
      container.appendChild(div);
      happyHourCount++;
      updateHappyHourCount();
    }
    
    function updateHappyHourCount() {
      const entries = document.querySelectorAll('.happy-hour-entry');
      document.getElementById('happy-hour-count').value = entries.length;
    }
  </script>
</div>
{% endblock %}